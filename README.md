# Telegram Crawler

Программа для сбора статистики публикаций из Telegram-каналов университетов.

## Описание

Программа собирает данные о публикациях из Telegram-каналов и групп, связанных с университетами (МГУ и СПбГУ), за последние 30 дней. Собранные данные включают:
- Дату публикации (в московском времени)
- Текст сообщения
- Количество просмотров
- Количество репостов

Результаты сохраняются в CSV-файл и визуализируются в виде графика.

## Структура проекта

```
telegram-crawler/
├── main.py               # Основной файл для запуска программы
├── auth.py               # Модуль для аутентификации в Telegram
├── data_collector.py     # Модуль для сбора и обработки данных
├── .env.example          # Пример файла с настройками
├── requirements.txt      # Зависимости проекта
└── README.md             # Документация проекта
```

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd telegram-crawler
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Создайте файл `.env` на основе `.env.example` и заполните его своими данными:
```
API_ID=your_api_id_here        # Получите на https://my.telegram.org
API_HASH=your_api_hash_here    # Получите на https://my.telegram.org
PHONE=your_phone_number_here   # В формате +7XXXXXXXXXX
```

## Получение API-ключей

1. Перейдите на https://my.telegram.org
2. Войдите в свой аккаунт Telegram
3. Перейдите в раздел "API development tools"
4. Создайте новое приложение
5. Скопируйте `api_id` и `api_hash` в файл `.env`

## Использование

1. Запустите программу:
```bash
python main.py
```

2. Если данные в `.env` отсутствуют, программа запросит их ввод:
   - API_ID (число)
   - API_HASH (строка)
   - Номер телефона в формате +7XXXXXXXXXX

3. Если включена двухфакторная аутентификация, потребуется ввести пароль.

4. После успешной аутентификации программа:
   - Найдет все каналы и группы, связанные с университетами
   - Соберет статистику публикаций за последние 30 дней (в московском времени)
   - Сохранит данные в файл `telegram_stats.csv`
   - Создаст график `daily_posts.png`

## Результаты

- `telegram_stats.csv` - таблица с собранными данными, где:
  - `university` - название университета
  - `publication_date` - дата публикации (в московском времени)
  - `message` - текст сообщения
  - `views` - количество просмотров
  - `forwards` - количество репостов

- `daily_posts.png` - график количества публикаций по дням

## Требования

- Python 3.7+
- telethon
- pandas
- matplotlib
- python-dotenv
- pytz

## Примечания

- Скрипт собирает данные только из публичных каналов и групп
- Для доступа к закрытым каналам и группам необходимо быть их участником
- При частых запросах Telegram может временно блокировать доступ
- При включенной двухфакторной аутентификации потребуется ввести дополнительный пароль
- ⚠️ **Важно**: При авторизации через API Telegram автоматически завершает все другие сессии на других устройствах в целях безопасности. После завершения работы скрипта вам нужно будет заново войти в Telegram на всех устройствах. 